## 堆

二进制堆是一个完全二叉树形式的数据结构（数组存储二叉树层序遍历结果），同时满足堆的性质：父节点值大于（大顶堆）或小于子节点值（小于）。由于采用数组的形式存储，内存的占用比普通的树小，用堆的目的是将最大（或者最小）的节点放在最前面，从而快速的进行相关插入、删除操作。一般用于构建优先队列，进行堆排序，快速找出集合中的最大（最小）值。

### 构建堆

```python
# 大顶堆
class MaxHeap:
    def __init__(self):
        self.heap = []
        self.cnt = 0
        
    # 将新节点插入堆最底部，整理堆结构
    def push(self, x):
        self.heap.append(x)
        self.shift_up(self.cnt)
        self.cnt += 1
    
    # 将堆顶节点输出，将堆底节点放置到堆顶，整理堆结构
    def pop(self):
        if self.cnt:
            ans = self.heap[0]
            self.cnt -= 1
            self.heap[0] = self.heap[-1]
            self.heap.pop()
            self.shift_down(0)
            return ans
        
	# 将当前节点与父节点交换位置
    def shift_up(self,idx):
        parent = (idx-1) >> 1
        while idx>0 and self.heap[parent]<self.heap[idx]:
            self.heap[parent], self.heap[idx] = self.heap[idx], self.heap[parent]
            idx = parent
            parent = (idx-1) >> 1
    
    # 将当前节点与较大的子节点交换位置
    def shift_down(self,idx):
        lc = (idx<<1) + 1	# 左节点
        while lc < self.cnt:
            if lc+1 < self.cnt and self.heap[lc+1] > self.heap[lc]:
                lc += 1		# 选择更大的右节点
            if self.heap[lc] > self.heap[idx]:
                self.heap[lc], self.heap[idx] = self.heap[idx], self.heap[lc]
                idx = lc
                lc = (idx<<1) + 1
            else:
                break
```

### heapq

* python内置的小顶堆模块

```python
heapq.heapify(heap)    # 将列表转化为堆结构
heapq.heappush(heap,num)   # 将数值加入堆
heapq.heappop(heap)        # 弹出最小值
heapq.heappushpop(heap, num)	   # 加入num后弹出最小值
heapq.heapreplace(heap,num)     # 替换最小值
heapq.nlargest(k,heap,[key=])     # 堆中最大的k个元素
heapq.nsmallest(k,heap,[key=])	   # 堆中最小的k个元素
heapq.merge(*iterables, key=None, reverse=False)	# 将多个已排序的输入合并为一个已排序的输出，返回已排序值的 iterator。
```

### [堆排序](../排序/排序)



